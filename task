1. Сделать поток из 10000 событий вида {"device": "rnd(1-2)", "doc_num": "rnd(1-10)"}
2. События направляются в rabbitmq
3. Воркер разгребает из rabbit и кладет в базу mongo. При сохранении нужно решить задачу удаления дублей по doc_num с каждого устройства.